{"ast":null,"code":"import _regeneratorRuntime from\"/Users/heoseongjae/Documents/\\u110C\\u1161\\u11A8\\u110B\\u1165\\u11B8/banto-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/heoseongjae/Documents/\\u110C\\u1161\\u11A8\\u110B\\u1165\\u11B8/banto-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/heoseongjae/Documents/\\u110C\\u1161\\u11A8\\u110B\\u1165\\u11B8/banto-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useMemo,useState}from\"react\";import axios from\"axios\";import constants from\"../../Constants\";import moment from\"moment\";import{Stack,Typography,Button}from\"@mui/material\";import{Box}from\"@mui/system\";import ReplyIcon from\"../../assets/icon/reply.png\";import CustomCenterBox from\"../../components/CustomCenterBox\";import BantoLogo from\"../../assets/icon/banto_text_logo.png\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogContentText from\"@material-ui/core/DialogContentText\";import DialogTitle from\"@material-ui/core/DialogTitle\";import ReturnSuccessImg from\"../../assets/img/return_success.png\";import ReturnCheckingImg from\"../../assets/img/return_checking.png\";import AgreeButton from\"../../components/AgreeButton\";import CancleButton from\"../../components/CancleButton\";var intervalBetween=function intervalBetween(rentTime){if(rentTime===null){return\"--: -- : --\";}var rentalTime=moment(rentTime);var now=moment();var diff=now.diff(rentalTime,\"seconds\",true);var formatted=moment.utc(diff*1000).format(\"HH : mm : ss\");return formatted;};function leadingZeros(n,digits){var zero=\"\";n=n.toString();if(n.length<digits){for(var i=0;i<digits-n.length;i++){zero+=\"0\";}}return zero+n;}function getTimeStamp(time){var d=new Date(time);var s=leadingZeros(d.getFullYear(),4)+\"-\"+leadingZeros(d.getMonth()+1,2)+\"-\"+leadingZeros(d.getDate(),2)+\" \"+leadingZeros(d.getHours(),2)+\":\"+leadingZeros(d.getMinutes(),2)+\":\"+leadingZeros(d.getSeconds(),2);return s;}export default function App(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),stationId=_useState2[0],setStationId=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),returned=_useState4[0],setReturned=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),rented=_useState6[0],setRented=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),rentStatus=_useState8[0],setRentStatus=_useState8[1];var _useState9=useState(\"-\"),_useState10=_slicedToArray(_useState9,2),storeName=_useState10[0],setStoreName=_useState10[1];var isoStartTime=useMemo(function(){return new Date(rented);},[rented]);var _useState11=useState(intervalBetween(rented)),_useState12=_slicedToArray(_useState11,2),runningTime=_useState12[0],setRunningTime=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),dialogOpen=_useState14[0],setDialogOpen=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),returnStatus=_useState16[0],setReturnStatus=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),reason=_useState18[0],setReason=_useState18[1];// 사용 시간\nuseEffect(function(){var interval=setInterval(function(){setRunningTime(intervalBetween(rented));},1000);return function(){clearInterval(interval);};},[isoStartTime]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,store;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(constants.hosts.banto+\"/banto2/app/store/getStoreName\",{stationId:sessionStorage.getItem(\"stationId\")});case 2:_yield$axios$post=_context.sent;store=_yield$axios$post.data;if(store.code===200){setStoreName(store.data.storeName);}case 5:case\"end\":return _context.stop();}}},_callee);}))();},[]);useEffect(function(){if(props.location.state!==undefined){setStationId(props.location.state.stationId);}},[]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(constants.hosts.banto+\"/banto2/app/rent/lastRent\",{userId:sessionStorage.getItem(\"userId\")});case 2:result=_context2.sent;if(!(result.data.code!==200)){_context2.next=6;break;}window.alert(\"시스템 에러: 반토 고객센터에 문의하세요\");return _context2.abrupt(\"return\");case 6:setRentStatus(result.data.data.bRenting&&result.data.data.bRenting.status);setReturned(result.data.data.bRenting&&result.data.data.bRenting.returnTimeStamp);setRented(result.data.data.bRenting&&result.data.data.bRenting.rentalTimeStamp);return _context2.abrupt(\"return\");case 10:case\"end\":return _context2.stop();}}},_callee2);}))();},[]);var returnCheck=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var result,msg,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.post(constants.hosts.banto+\"/banto2/app/rent/lastRent\",{userId:sessionStorage.getItem(\"userId\")});case 2:result=_context3.sent;if(!(result.data.code!==200)){_context3.next=6;break;}window.alert(\"시스템 에러: 반토 고객센터에 문의하세요\");return _context3.abrupt(\"return\");case 6:setRentStatus(result.data.data.bRenting&&result.data.data.bRenting.status);setReturned(result.data.data.bRenting&&result.data.data.bRenting.returnTimeStamp);setRented(result.data.data.bRenting&&result.data.data.bRenting.rentalTimeStamp);if(!(result.data.data.bRenting&&result.data.data.bRenting.returnTimeStamp!==null)){_context3.next=20;break;}// setReturnStatus(true);\nmsg=\"반납이 완료되었습니다\";if(!(result.data.data.bRenting.status===\"return_payment_fail\")){_context3.next=18;break;}_context3.next=14;return axios.get(\"\".concat(constants.hosts.banto,\"/banto2/app/log/\").concat(result.data.data.bRenting.userId,\"/payment-fail/\").concat(result.data.data.bRenting.rentId));case 14:_yield$axios$get=_context3.sent;data=_yield$axios$get.data;setReason(data.reason);msg+=\"\\n\".concat(data.reason);case 18:_context3.next=21;break;case 20:setReturnStatus(false);// alert(\n//   `반납은 10초가량 소요될 수 있습니다.\\n\\n배터리를 꾸욱 눌러주세요.\\n\\n반납이 되지 않을시 스테이션 뒤의 전원을 껐다 켜주세요`\n// );\ncase 21:setDialogOpen(true);return _context3.abrupt(\"return\",{code:200});case 23:case\"end\":return _context3.stop();}}},_callee3);}));return function returnCheck(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Box,{sx:{backgroundColor:\"#0B0B0C\",height:\"100vh\"}},/*#__PURE__*/React.createElement(CustomCenterBox,{sx:{pt:\"20%\"}},/*#__PURE__*/React.createElement(CustomCenterBox,{sx:{p:3,alignItems:\"center\"}},/*#__PURE__*/React.createElement(\"img\",{src:BantoLogo,alt:\"\"}))),/*#__PURE__*/React.createElement(CustomCenterBox,null,/*#__PURE__*/React.createElement(Typography,{color:\"#00E676\",fontFamily:\"Montserrat\",fontWeight:700,fontSize:50},rentStatus===\"return_payment_fail\"?\"반납 결제 실패\":runningTime),/*#__PURE__*/React.createElement(Typography,{color:\"#00E676\",fontWeight:300},\"\\uD604\\uC7AC \\uC774\\uC6A9 \\uC2DC\\uAC04\")),/*#__PURE__*/React.createElement(Box,{sx:{p:1,pl:2,pr:2}},/*#__PURE__*/React.createElement(Box,{sx:{backgroundColor:\"black\",border:\"2px solid #242427\",boxSizing:\"border-box\",borderRadius:\"15px\"}},/*#__PURE__*/React.createElement(Box,{sx:{p:3}},/*#__PURE__*/React.createElement(Stack,{spacing:3},/*#__PURE__*/React.createElement(Box,{sx:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(Typography,{color:\"#94949d\",fontSize:14},\"\\uB300\\uC5EC \\uC2DC\\uAC04\"),/*#__PURE__*/React.createElement(Typography,{color:\"#EAEBF1\",fontWeight:600,fontSize:16},rented&&getTimeStamp(rented))),/*#__PURE__*/React.createElement(Box,{sx:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(Typography,{color:\"#94949d\",fontSize:14},\"\\uB0A8\\uC740 \\uC2DC\\uAC04\"),/*#__PURE__*/React.createElement(Typography,{color:\"#EAEBF1\",fontWeight:600,fontSize:16},\"-\")),/*#__PURE__*/React.createElement(Box,{sx:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(Typography,{color:\"#94949d\",fontSize:14},\"\\uB300\\uC5EC \\uC9C0\\uC810\"),/*#__PURE__*/React.createElement(Typography,{color:\"#EAEBF1\",fontWeight:600,fontSize:16},storeName)),/*#__PURE__*/React.createElement(Box,{sx:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(Box,null,/*#__PURE__*/React.createElement(Typography,{color:\"#94949d\",fontSize:14},\"\\uCD94\\uAC00 \\uC774\\uC6A9\\uB8CC\"),/*#__PURE__*/React.createElement(Typography,{color:\"#94949d\",fontSize:14},\"(10\\uBD84/150\\uC6D0)\")),/*#__PURE__*/React.createElement(Typography,{color:\"#EAEBF1\",fontWeight:600,fontSize:16},\"-\")))))),/*#__PURE__*/React.createElement(Box,{p:2},/*#__PURE__*/React.createElement(Button,{sx:{width:\"100%\",border:\"2px solid #313139\",borderRadius:\"15px\",color:\"#00C853\",justifyContent:\"space-between\",padding:\"10px 24px\"},onClick:returnCheck},\"\\uBC18\\uB0A9 \\uD655\\uC778\",/*#__PURE__*/React.createElement(\"img\",{src:ReplyIcon,alt:\"\",width:\"4%\"}))),/*#__PURE__*/React.createElement(Dialog,{fullScreen:true,open:dialogOpen,onClose:function onClose(){setDialogOpen(false);}},/*#__PURE__*/React.createElement(Box,{sx:{backgroundColor:\"#0B0B0C\",height:\"100vh\"}},/*#__PURE__*/React.createElement(CustomCenterBox,{sx:{pt:30}},returnStatus?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"img\",{src:ReturnSuccessImg,alt:\"\"}),/*#__PURE__*/React.createElement(Box,{pt:5},/*#__PURE__*/React.createElement(Typography,{color:\"white\",fontSize:24},\"\\uBCF4\\uC870\\uBC30\\uD130\\uB9AC \\uBC18\\uB0A9 \\uC644\\uB8CC\"),reason!==null&&reason!==void 0?reason:/*#__PURE__*/React.createElement(Typography,{color:\"white\",fontSize:24},reason)),/*#__PURE__*/React.createElement(Box,{pt:5},/*#__PURE__*/React.createElement(AgreeButton,{text:\"\\uD655\\uC778\",onClick:function onClick(){props.history.push(\"/\");}}))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"img\",{src:ReturnCheckingImg,alt:\"\"}),/*#__PURE__*/React.createElement(Box,{pt:5},/*#__PURE__*/React.createElement(Typography,{color:\"white\",fontSize:24},\"\\uBCF4\\uC870\\uBC30\\uD130\\uB9AC \\uBC18\\uB0A9 \\uD655\\uC778 \\uC911\"),/*#__PURE__*/React.createElement(Typography,{color:\"white\",fontSize:24},\"\\uC7A0\\uC2DC \\uD6C4 \\uB2E4\\uC2DC \\uD655\\uC778\\uD574\\uC8FC\\uC138\\uC694\")),/*#__PURE__*/React.createElement(Box,{pt:5},/*#__PURE__*/React.createElement(CancleButton,{text:\"\\uB3CC\\uC544\\uAC00\\uAE30\",onClick:function onClick(){setDialogOpen(false);}})))))));}","map":{"version":3,"sources":["/Users/heoseongjae/Documents/작업/banto-web/src/pages/simplePay/SimplePayRenting.js"],"names":["React","useEffect","useMemo","useState","axios","constants","moment","Stack","Typography","Button","Box","ReplyIcon","CustomCenterBox","BantoLogo","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","ReturnSuccessImg","ReturnCheckingImg","AgreeButton","CancleButton","intervalBetween","rentTime","rentalTime","now","diff","formatted","utc","format","leadingZeros","n","digits","zero","toString","length","i","getTimeStamp","time","d","Date","s","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","App","props","stationId","setStationId","returned","setReturned","rented","setRented","rentStatus","setRentStatus","storeName","setStoreName","isoStartTime","runningTime","setRunningTime","dialogOpen","setDialogOpen","returnStatus","setReturnStatus","reason","setReason","interval","setInterval","clearInterval","post","hosts","banto","sessionStorage","getItem","store","data","code","location","state","undefined","userId","result","window","alert","bRenting","status","returnTimeStamp","rentalTimeStamp","returnCheck","msg","get","rentId","backgroundColor","height","pt","p","alignItems","pl","pr","border","boxSizing","borderRadius","display","flexDirection","justifyContent","width","color","padding","history","push"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\nimport axios from \"axios\";\nimport constants from \"../../Constants\";\nimport moment from \"moment\";\n\nimport { Stack, Typography, Button } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport ReplyIcon from \"../../assets/icon/reply.png\";\nimport CustomCenterBox from \"../../components/CustomCenterBox\";\n\nimport BantoLogo from \"../../assets/icon/banto_text_logo.png\";\n\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n\nimport ReturnSuccessImg from \"../../assets/img/return_success.png\";\nimport ReturnCheckingImg from \"../../assets/img/return_checking.png\";\nimport AgreeButton from \"../../components/AgreeButton\";\nimport CancleButton from \"../../components/CancleButton\";\n\nconst intervalBetween = (rentTime) => {\n  if (rentTime === null) {\n    return \"--: -- : --\";\n  }\n  var rentalTime = moment(rentTime);\n  var now = moment();\n\n  var diff = now.diff(rentalTime, \"seconds\", true);\n  const formatted = moment.utc(diff * 1000).format(\"HH : mm : ss\");\n\n  return formatted;\n};\n\nfunction leadingZeros(n, digits) {\n  var zero = \"\";\n  n = n.toString();\n\n  if (n.length < digits) {\n    for (let i = 0; i < digits - n.length; i++) zero += \"0\";\n  }\n  return zero + n;\n}\n\nfunction getTimeStamp(time) {\n  var d = new Date(time);\n  var s =\n    leadingZeros(d.getFullYear(), 4) +\n    \"-\" +\n    leadingZeros(d.getMonth() + 1, 2) +\n    \"-\" +\n    leadingZeros(d.getDate(), 2) +\n    \" \" +\n    leadingZeros(d.getHours(), 2) +\n    \":\" +\n    leadingZeros(d.getMinutes(), 2) +\n    \":\" +\n    leadingZeros(d.getSeconds(), 2);\n\n  return s;\n}\n\nexport default function App(props) {\n  const [stationId, setStationId] = useState(\"\");\n  const [returned, setReturned] = useState(null);\n  const [rented, setRented] = useState(null);\n  const [rentStatus, setRentStatus] = useState(null);\n\n  const [storeName, setStoreName] = useState(\"-\");\n\n  const isoStartTime = useMemo(() => new Date(rented), [rented]);\n  const [runningTime, setRunningTime] = useState(intervalBetween(rented));\n\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [returnStatus, setReturnStatus] = useState(false);\n\n  const [reason, setReason] = useState(\"\");\n\n  // 사용 시간\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setRunningTime(intervalBetween(rented));\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [isoStartTime]);\n\n  useEffect(() => {\n    (async () => {\n      const { data: store } = await axios.post(\n        constants.hosts.banto + \"/banto2/app/store/getStoreName\",\n        {\n          stationId: sessionStorage.getItem(\"stationId\"),\n        }\n      );\n\n      if (store.code === 200) {\n        setStoreName(store.data.storeName);\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (props.location.state !== undefined) {\n      setStationId(props.location.state.stationId);\n    }\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      const result = await axios.post(\n        constants.hosts.banto + \"/banto2/app/rent/lastRent\",\n        {\n          userId: sessionStorage.getItem(\"userId\"),\n        }\n      );\n\n      if (result.data.code !== 200) {\n        window.alert(\"시스템 에러: 반토 고객센터에 문의하세요\");\n        return;\n      }\n      setRentStatus(\n        result.data.data.bRenting && result.data.data.bRenting.status\n      );\n      setReturned(\n        result.data.data.bRenting && result.data.data.bRenting.returnTimeStamp\n      );\n      setRented(\n        result.data.data.bRenting && result.data.data.bRenting.rentalTimeStamp\n      );\n\n      return;\n    })();\n  }, []);\n\n  const returnCheck = async () => {\n    const result = await axios.post(\n      constants.hosts.banto + \"/banto2/app/rent/lastRent\",\n      {\n        userId: sessionStorage.getItem(\"userId\"),\n      }\n    );\n\n    if (result.data.code !== 200) {\n      window.alert(\"시스템 에러: 반토 고객센터에 문의하세요\");\n      return;\n    }\n    setRentStatus(\n      result.data.data.bRenting && result.data.data.bRenting.status\n    );\n    setReturned(\n      result.data.data.bRenting && result.data.data.bRenting.returnTimeStamp\n    );\n    setRented(\n      result.data.data.bRenting && result.data.data.bRenting.rentalTimeStamp\n    );\n\n    if (\n      result.data.data.bRenting &&\n      result.data.data.bRenting.returnTimeStamp !== null\n    ) {\n      // setReturnStatus(true);\n      let msg = \"반납이 완료되었습니다\";\n\n      if (result.data.data.bRenting.status === \"return_payment_fail\") {\n        const { data } = await axios.get(\n          `${constants.hosts.banto}/banto2/app/log/${result.data.data.bRenting.userId}/payment-fail/${result.data.data.bRenting.rentId}`\n        );\n\n        setReason(data.reason);\n        msg += `\\n${data.reason}`;\n      }\n\n      // props.history.push(\"/simple/rentcomplete\");\n    } else {\n      setReturnStatus(false);\n\n      // alert(\n      //   `반납은 10초가량 소요될 수 있습니다.\\n\\n배터리를 꾸욱 눌러주세요.\\n\\n반납이 되지 않을시 스테이션 뒤의 전원을 껐다 켜주세요`\n      // );\n    }\n\n    setDialogOpen(true);\n\n    return { code: 200 };\n  };\n\n  return (\n    <Box sx={{ backgroundColor: \"#0B0B0C\", height: \"100vh\" }}>\n      <CustomCenterBox sx={{ pt: \"20%\" }}>\n        <CustomCenterBox sx={{ p: 3, alignItems: \"center\" }}>\n          <img src={BantoLogo} alt=\"\" />\n          {/* <Typography color=\"white\" fontSize={40} fontWeight={700}>\n            BANTO\n          </Typography> */}\n        </CustomCenterBox>\n      </CustomCenterBox>\n\n      <CustomCenterBox>\n        <Typography\n          color=\"#00E676\"\n          fontFamily=\"Montserrat\"\n          fontWeight={700}\n          fontSize={50}\n        >\n          {rentStatus === \"return_payment_fail\"\n            ? \"반납 결제 실패\"\n            : runningTime}\n        </Typography>\n        <Typography color=\"#00E676\" fontWeight={300}>\n          현재 이용 시간\n        </Typography>\n      </CustomCenterBox>\n\n      <Box sx={{ p: 1, pl: 2, pr: 2 }}>\n        <Box\n          sx={{\n            backgroundColor: \"black\",\n            border: \"2px solid #242427\",\n            boxSizing: \"border-box\",\n            borderRadius: \"15px\",\n          }}\n        >\n          <Box sx={{ p: 3 }}>\n            <Stack spacing={3}>\n              <Box\n                sx={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <Typography color=\"#94949d\" fontSize={14}>\n                  대여 시간\n                </Typography>\n                <Typography color=\"#EAEBF1\" fontWeight={600} fontSize={16}>\n                  {rented && getTimeStamp(rented)}\n                </Typography>\n              </Box>\n\n              <Box\n                sx={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <Typography color=\"#94949d\" fontSize={14}>\n                  남은 시간\n                </Typography>\n                <Typography color=\"#EAEBF1\" fontWeight={600} fontSize={16}>\n                  -\n                </Typography>\n              </Box>\n\n              <Box\n                sx={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <Typography color=\"#94949d\" fontSize={14}>\n                  대여 지점\n                </Typography>\n                <Typography color=\"#EAEBF1\" fontWeight={600} fontSize={16}>\n                  {storeName}\n                </Typography>\n              </Box>\n              <Box\n                sx={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <Box>\n                  <Typography color=\"#94949d\" fontSize={14}>\n                    추가 이용료\n                  </Typography>\n                  <Typography color=\"#94949d\" fontSize={14}>\n                    (10분/150원)\n                  </Typography>\n                </Box>\n                <Typography color=\"#EAEBF1\" fontWeight={600} fontSize={16}>\n                  -\n                </Typography>\n              </Box>\n            </Stack>\n          </Box>\n        </Box>\n      </Box>\n\n      <Box p={2}>\n        <Button\n          sx={{\n            width: \"100%\",\n            border: \"2px solid #313139\",\n            borderRadius: \"15px\",\n            color: \"#00C853\",\n            justifyContent: \"space-between\",\n            padding: \"10px 24px\",\n          }}\n          onClick={returnCheck}\n        >\n          반납 확인\n          <img src={ReplyIcon} alt=\"\" width=\"4%\" />\n        </Button>\n      </Box>\n\n      <Dialog\n        fullScreen\n        open={dialogOpen}\n        onClose={() => {\n          setDialogOpen(false);\n        }}\n      >\n        <Box sx={{ backgroundColor: \"#0B0B0C\", height: \"100vh\" }}>\n          <CustomCenterBox sx={{ pt: 30 }}>\n            {returnStatus ? (\n              <>\n                <img src={ReturnSuccessImg} alt=\"\" />\n                <Box pt={5}>\n                  <Typography color=\"white\" fontSize={24}>\n                    보조배터리 반납 완료\n                  </Typography>\n                  {reason ?? (\n                    <Typography color=\"white\" fontSize={24}>\n                      {reason}\n                    </Typography>\n                  )}\n                </Box>\n                <Box pt={5}>\n                  <AgreeButton\n                    text=\"확인\"\n                    onClick={() => {\n                      props.history.push(\"/\");\n                    }}\n                  />\n                </Box>\n              </>\n            ) : (\n              <>\n                <img src={ReturnCheckingImg} alt=\"\" />\n                <Box pt={5}>\n                  <Typography color=\"white\" fontSize={24}>\n                    보조배터리 반납 확인 중\n                  </Typography>\n                  <Typography color=\"white\" fontSize={24}>\n                    잠시 후 다시 확인해주세요\n                  </Typography>\n                </Box>\n                <Box pt={5}>\n                  <CancleButton\n                    text=\"돌아가기\"\n                    onClick={() => {\n                      setDialogOpen(false);\n                    }}\n                  />\n                </Box>\n              </>\n            )}\n          </CustomCenterBox>\n        </Box>\n      </Dialog>\n    </Box>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}